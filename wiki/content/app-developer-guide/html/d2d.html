<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 12. Device-To-Device Push Framework</title><link rel="stylesheet" href="css/seamframework.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="OpenMobster - Mobile Cloud Platform"/><link rel="up" href="index.html" title="OpenMobster - Mobile Cloud Platform"/><link rel="prev" href="ios_sampleapp.html" title="Chapter 11. iOS + OpenMobster Sample App"/><link rel="next" href="pg_sample.html" title="Chapter 13. PhoneGap: Offline Web Apps using the Sync Plugin"/></head><body><p id="title"><a href="http://www.seamframework.org" class="site_href"><strong>SeamFramework.org</strong></a><a href="http://www.seamframework.org/Documentation" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="ios_sampleapp.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="pg_sample.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d2d"/>Chapter 12. Device-To-Device Push Framework</h2></div><div><div class="author"><h3 class="author"><span class="firstname">openmobster</span> <span class="surname">at gmail.com</span></h3><code class="email">&lt;<a class="email" href="mailto:openmobster@gmail.com">openmobster@gmail.com</a>&gt;</code></div></div></div></div><div class="toc"><dl><dt><span class="sect1"><a href="d2d.html#d0e1742">12.1. Introduction</a></span></dt><dt><span class="sect1"><a href="d2d.html#d0e1750">12.2. Integration</a></span></dt><dd><dl><dt><span class="sect2"><a href="d2d.html#d0e1753">12.2.1. Step 1: Extend org.openmobster.android.api.d2d.D2DActivity</a></span></dt><dt><span class="sect2"><a href="d2d.html#d0e1774">12.2.2. Step 2: Configuration</a></span></dt><dt><span class="sect2"><a href="d2d.html#d0e1816">12.2.3. Step 3: Sample App</a></span></dt></dl></dd></dl></div><div class="sect1" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1742"/>12.1. Introduction</h2></div></div></div><p>
   		 	OpenMobster <span class="bold"><strong>2.2-M7</strong></span>, introduces a new device to device push framework. Using this framework developers can write Apps which communicate with other devices in the cloud and vice versa. Some applications of this would be a Chat App or an Instant Messaging App.
   		</p></div><div class="sect1" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1750"/>12.2. Integration</h2></div></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1753"/>12.2.1. Step 1: Extend <span class="bold"><strong>org.openmobster.android.api.d2d.D2DActivity</strong></span></h3></div></div></div><p>
   				Override the <span class="bold"><strong>onStart</strong></span> method to start the CloudService
   				</p><pre class="programlisting">
   				
   				@Override
        protected void onStart()
        {
                super.onStart();
                
                CloudService.getInstance().start(this);
        }		
        		
   				</pre><p>
   			</p><p>
   				Implement the <span class="bold"><strong>callback</strong></span> method to handle the GUI aspects of receiving an incoming push message 
   				</p><pre class="programlisting">
   				
   				public void callback(D2DMessage message)
        {
                //Append a newly received message from the chat system
                LinearLayout layout = (LinearLayout)ViewHelper.findViewById(MainActivity.this, "layout");
                TextView chatView = new TextView(MainActivity.this);
                chatView.setText(message.getMessage());
                layout.addView(chatView);
                
                Toast.makeText(MainActivity.this, message.getMessage(), Toast.LENGTH_SHORT).show();
                
                TextView user = (TextView)ViewHelper.findViewById(this, "user");
                user.setText(message.getFrom());
                this.to = message.getFrom();
        }
   				
   				</pre><p>
   			</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1774"/>12.2.2. Step 2: Configuration</h3></div></div></div><p>In <span class="bold"><strong>AndroidManifest.xml</strong></span>, register the <span class="bold"><strong>org.openmobster.android.api.d2d.D2DReceiver</strong></span> broadcast receiver </p><pre class="programlisting">
   				
   				&lt;receiver android:name="org.openmobster.android.api.d2d.D2DReceiver"&gt;
                &lt;intent-filter&gt;
                    &lt;!-- action should be d2d://{packagename} of the App --&gt;
                    &lt;action android:name="d2d://com.chat.android.app" /&gt;
                &lt;/intent-filter&gt;
         &lt;/receiver&gt;
   				
   			</pre><p>
   			Also in <span class="bold"><strong>AndroidManifest.xml</strong></span>, register the <span class="bold"><strong>org.openmobster.core.mobileCloud.api.ui.framework.push.PushBroadcastReceiver</strong></span> to receive and notify arrival of Push messages 
   			</p><pre class="programlisting">
   			
   			&lt;receiver android:name="org.openmobster.core.mobileCloud.api.ui.framework.push.PushBroadcastReceiver"&gt;
                &lt;intent-filter&gt;
                        &lt;!-- Action should be the {packagename} of the App--&gt;
                        &lt;action android:name="com.chat.android.app"/&gt;
                &lt;/intent-filter&gt;
        &lt;/receiver&gt;
   			
   			</pre><p>
   				In <span class="bold"><strong>openmobster-app.xml</strong></span>, configure the Push settings as follows: 
   			</p><pre class="programlisting">
   			
   			&lt;app-conf&gt;
        &lt;encryption&gt;false&lt;/encryption&gt;
        
        &lt;push&gt;
                &lt;launch-activity-class&gt;org.openmobster.app.MainActivity&lt;/launch-activity-class&gt;
                &lt;icon-name&gt;push&lt;/icon-name&gt;
        &lt;/push&gt;
&lt;/app-conf&gt;
   			
   			</pre><p>
   				</p><div class="itemizedlist"><ul><li><span class="bold"><strong>launch-activity-class:</strong></span> Is the Activity that must be launched when a Push notification is clicked</li><li><span class="bold"><strong>icon-name:</strong></span> Is the icon to display with the Push notification</li></ul></div><p>
   			</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1816"/>12.2.3. Step 3: Sample App</h3></div></div></div><p>
   			The OpenMobster, <span class="bold"><strong>2.2-M7</strong></span> binary distribution comes packaged with a sample application for the <span class="bold"><strong>Device-To-Device Push Framework</strong></span>. It is a simple Chat app and its goal is to show how the framework should be used to build more complex app. The app is located under <span class="bold"><strong>AppCreator/sampleApps/chat</strong></span>
   			</p></div></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="ios_sampleapp.html"><strong>Prev</strong>Chapter 11. iOS + OpenMobster Sample App</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="pg_sample.html"><strong>Next</strong>Chapter 13. PhoneGap: Offline Web Apps using the ...</a></li></ul></body></html>